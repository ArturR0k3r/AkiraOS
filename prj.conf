###############################################################################
# AkiraOS Main Configuration
# Universal settings for all platforms - board-specific in boards/*.conf
###############################################################################

###############################################################################
# Core Peripherals (common to all platforms)
###############################################################################
CONFIG_GPIO=y
CONFIG_PINCTRL=y

###############################################################################
# Kernel & Threads
###############################################################################
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024
CONFIG_IDLE_STACK_SIZE=512
CONFIG_DYNAMIC_THREAD=y
CONFIG_DYNAMIC_THREAD_ALLOC=y
CONFIG_KERNEL_MEM_POOL=y
CONFIG_HEAP_MEM_POOL_SIZE=16384
CONFIG_SYS_HEAP_RUNTIME_STATS=y
CONFIG_THREAD_MONITOR=y
CONFIG_THREAD_NAME=y
CONFIG_THREAD_STACK_INFO=y

# State Machine Framework (needed by OCRE)
CONFIG_SMF=y
CONFIG_SMF_ANCESTOR_SUPPORT=y
CONFIG_SMF_INITIAL_TRANSITION=y

# Runtime Statistics
CONFIG_STATS=y
CONFIG_STATS_NAMES=y

# Stack Protection
CONFIG_STACK_SENTINEL=y   
CONFIG_STACK_CANARIES=y   

###############################################################################
# Logging & Debug
###############################################################################
CONFIG_DEBUG_OPTIMIZATIONS=y
CONFIG_LOG=y
# Level 0=OFF, 1=ERROR, 2=WARNING, 3=INFO, 4=DEBUG
# Set to 3 (INFO) to see initialization messages
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_LOG_MAX_LEVEL=4
CONFIG_LOG_PRINTK=y    
CONFIG_DISPLAY_LOG_LEVEL_ERR=y

###############################################################################
# Console & Shell
###############################################################################
CONFIG_CONSOLE=y
CONFIG_UART_CONSOLE=y
CONFIG_SHELL=y
CONFIG_SHELL_BACKENDS=y
CONFIG_SHELL_BACKEND_SERIAL=y
CONFIG_SHELL_PROMPT_UART="akira:~$ "
CONFIG_SHELL_CMD_BUFF_SIZE=96
CONFIG_SHELL_ARGC_MAX=6
CONFIG_SHELL_TAB=y
CONFIG_SHELL_TAB_AUTOCOMPLETION=y
CONFIG_SHELL_HISTORY=y
CONFIG_SHELL_HISTORY_BUFFER=64

###############################################################################
# Bluetooth (use CONFIG_AKIRA_BLUETOOTH=y in Kconfig for auto-deps)
###############################################################################
CONFIG_AKIRA_BLUETOOTH=y
CONFIG_BT_DEVICE_NAME="AkiraOS"
CONFIG_BT_MAX_CONN=1
# Reduce BT buffer sizes to save DRAM
CONFIG_BT_L2CAP_TX_MTU=128
CONFIG_BT_BUF_ACL_RX_SIZE=128
CONFIG_BT_BUF_ACL_TX_SIZE=128
CONFIG_BT_ATT_PREPARE_COUNT=1
# Increased stack sizes for HID support (prevent stack overflow)
CONFIG_BT_RX_STACK_SIZE=2048
CONFIG_BT_HCI_TX_STACK_SIZE=1024
CONFIG_BT_KEYS_OVERWRITE_OLDEST=y

# HID Subsystem
CONFIG_AKIRA_HID=y
CONFIG_AKIRA_HID_KEYBOARD=y
CONFIG_AKIRA_HID_GAMEPAD=y
CONFIG_AKIRA_BT_HID=y

###############################################################################
# Display & Input
###############################################################################
CONFIG_DISPLAY=y
CONFIG_INPUT=y
CONFIG_INPUT_GPIO_KEYS=y

###############################################################################
# Storage (use CONFIG_AKIRA_STORAGE=y in Kconfig for auto-deps)
###############################################################################
CONFIG_AKIRA_STORAGE=y
CONFIG_FILE_SYSTEM_SHELL=y
CONFIG_SETTINGS_FILE=y
CONFIG_SETTINGS_RUNTIME=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y
CONFIG_STREAM_FLASH=y

###############################################################################
# MCUboot / OTA
###############################################################################
CONFIG_BOOTLOADER_MCUBOOT=y
CONFIG_MCUBOOT_IMG_MANAGER=y      
CONFIG_IMG_MANAGER=y          
CONFIG_IMG_ENABLE_IMAGE_CHECK=y   
CONFIG_IMG_ERASE_PROGRESSIVELY=y  
CONFIG_MCUBOOT_SIGNATURE_KEY_FILE="" 

###############################################################################
# Cryptography
###############################################################################
CONFIG_MBEDTLS=y
CONFIG_MBEDTLS_BUILTIN=y
CONFIG_MBEDTLS_RSA_C=y
CONFIG_MBEDTLS_PKCS1_V15=y

###############################################################################
# POSIX / Misc
###############################################################################
CONFIG_POSIX_API=y
CONFIG_REBOOT=y               

###############################################################################
# OCRE Runtime Configuration
###############################################################################
CONFIG_OCRE=y
CONFIG_OCRE_WAMR_INTERPRETER=y
CONFIG_OCRE_DEFAULT_WORKING_DIRECTORY="/lfs/ocre"
CONFIG_OCRE_LOG_LEVEL=3
CONFIG_OCRE_WAMR_LOG_LEVEL=3
CONFIG_MAX_CONTAINERS=2

###############################################################################
# App Manager
###############################################################################
CONFIG_AKIRA_APP_MANAGER=y
CONFIG_AKIRA_APP_MAX_INSTALLED=4
CONFIG_AKIRA_APP_MAX_RUNNING=1
CONFIG_AKIRA_APP_SOURCE_BLE=y

###############################################################################
# OTA Manager
###############################################################################
CONFIG_AKIRA_OTA=y
CONFIG_AKIRA_OTA_BLE=y

###############################################################################
# Settings
###############################################################################
CONFIG_AKIRA_SETTINGS=y
