// SPDX-License-Identifier: Apache-2.0

/dts-v1/;

#include <espressif/esp32/esp32_wrover_e_n4r8.dtsi>
#include "akira_basic_esp32-pinctrl.dtsi"

/ {
    model = "Akira Basic ESP32 Console";
    compatible = "akira,basic-esp32";

    chosen {
        zephyr,sram = &sram0;
        zephyr,console = &uart0;
        zephyr,shell-uart = &uart0;
        zephyr,flash = &flash0;
        zephyr,display = &ili9341;
    };

    aliases {
        led0 = &status_led;
        led1 = &charge_led;
        sw0 = &key_up;
        sw1 = &key_right;
        sw2 = &key_down;
        sw3 = &key_left;
        sw4 = &key_a;
        sw5 = &key_b;
        sw6 = &key_x;
        sw7 = &key_y;
        sw8 = &key_settings;
    };

    leds {
        compatible = "gpio-leds";
        status_led: status_led {
            gpios = <&gpio0 12 GPIO_ACTIVE_HIGH>;
            label = "Status LED (Blue)";
        };
        charge_led: charge_led {
            gpios = <&gpio0 13 GPIO_ACTIVE_HIGH>;
            label = "Charge LED (Yellow)";
        };
    };

    gpio_keys {
        compatible = "gpio-keys";
        
        key_up: key_up {
            gpios = <&gpio0 36 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "UP Button";
        };
        key_right: key_right {
            gpios = <&gpio0 39 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "RIGHT Button";
        };
        key_down: key_down {
            gpios = <&gpio0 34 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "DOWN Button";
        };
        key_left: key_left {
            gpios = <&gpio0 35 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "LEFT Button";
        };
        key_a: key_a {
            gpios = <&gpio0 32 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "A Button";
        };
        key_b: key_b {
            gpios = <&gpio0 33 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "B Button";
        };
        key_x: key_x {
            gpios = <&gpio0 25 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "X Button";
        };
        key_y: key_y {
            gpios = <&gpio0 26 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "Y Button";
        };
        key_settings: key_settings {
            gpios = <&gpio0 27 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
            label = "Settings Button";
        };
    };

    mipi_dbi {
        compatible = "zephyr,mipi-dbi-spi";
        spi-dev = <&spi2>;
        dc-gpios = <&gpio0 2 GPIO_ACTIVE_HIGH>;
        reset-gpios = <&gpio0 4 GPIO_ACTIVE_LOW>;
        #address-cells = <1>;
        #size-cells = <0>;

        ili9341: ili9341@0 {
            compatible = "ilitek,ili9341";
            reg = <0>;
            spi-max-frequency = <25000000>;
            width = <240>;
            height = <320>;
            rotation = <0>;
        };
    };
};

&spi2 {
    status = "okay";
    pinctrl-0 = <&spim2_default>;
    pinctrl-names = "default";
    
    cs-gpios = <&gpio0 5 GPIO_ACTIVE_LOW>,   // Display CS
               <&gpio0 17 GPIO_ACTIVE_LOW>,  // Touch CS  
               <&gpio0 15 GPIO_ACTIVE_LOW>;  // SD Card CS
};

&wifi {
    status = "okay";
};

&uart0 {
    status = "okay";
    current-speed = <115200>;
    pinctrl-0 = <&uart0_default>;
    pinctrl-names = "default";
};