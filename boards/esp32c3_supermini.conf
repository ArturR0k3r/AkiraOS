###############################################################################
# ESP32-C3 SuperMini Board Configuration
# RISC-V single-core @ 160MHz, 4MB Flash, ~400KB SRAM, WiFi + BLE 5.0
###############################################################################

###############################################################################
# Memory Configuration - VERY LIMITED SRAM (~400KB total)
###############################################################################
# Minimal DRAM heap - most allocations via stack or fixed buffers
CONFIG_HEAP_MEM_POOL_SIZE=8192
CONFIG_MAIN_STACK_SIZE=2560
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=768
CONFIG_SHELL_STACK_SIZE=2048
CONFIG_ISR_STACK_SIZE=1536
CONFIG_IDLE_STACK_SIZE=256

###############################################################################
# WiFi - Auto-enabled via AKIRA_WIFI (defined in prj.conf)
###############################################################################
CONFIG_WIFI_ESP32=y
CONFIG_ESP32_WIFI_STA_AUTO_DHCPV4=y
# Disable AMPDU to reduce memory on this RAM-constrained board
CONFIG_ESP32_WIFI_AMPDU_TX_ENABLED=n
CONFIG_ESP32_WIFI_AMPDU_RX_ENABLED=n

###############################################################################
# Bluetooth (BLE 5.0) - Tuned for minimal RAM usage
###############################################################################
# Reduced BT buffer sizes to save SRAM
CONFIG_BT_BUF_ACL_RX_SIZE=128
CONFIG_BT_BUF_ACL_TX_SIZE=128
CONFIG_BT_L2CAP_TX_MTU=128
CONFIG_BT_RX_STACK_SIZE=1280
CONFIG_BT_HCI_TX_STACK_SIZE=640
CONFIG_BT_ATT_PREPARE_COUNT=1
CONFIG_BT_KEYS_OVERWRITE_OLDEST=y

###############################################################################
# Network Buffer Configuration - minimal for ESP32-C3
###############################################################################
CONFIG_NET_BUF_DATA_SIZE=128
CONFIG_NET_PKT_RX_COUNT=4
CONFIG_NET_PKT_TX_COUNT=4
CONFIG_NET_BUF_RX_COUNT=8
CONFIG_NET_BUF_TX_COUNT=8

###############################################################################
# SPI & I2C for peripherals
###############################################################################
CONFIG_SPI=y
CONFIG_I2C=y
CONFIG_SENSOR=y

###############################################################################
# OCRE Memory - ESP32-C3 not recommended for WAMR due to RAM constraints
###############################################################################
CONFIG_MAX_CONTAINERS=1
CONFIG_OCRE_CONTAINER_DEFAULT_STACK_SIZE=2048
CONFIG_OCRE_CONTAINER_DEFAULT_HEAP_SIZE=2048

###############################################################################
# ESP32-C3 Flash Configuration
###############################################################################
CONFIG_ESPTOOLPY_FLASHSIZE_4MB=y
CONFIG_ESPTOOLPY_FLASHMODE_DIO=y
CONFIG_ESPTOOLPY_FLASHFREQ_40M=y

###############################################################################
# Logging - Minimal for RAM-constrained device
###############################################################################
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_LOG_DEFAULT_LEVEL=1

###############################################################################
# Settings Backend (NVS for ESP32)
###############################################################################
CONFIG_SETTINGS_NVS=y

###############################################################################
# Note: This board has limited SRAM. Recommended configuration:
# - Disable unused features in prj.conf with CONFIG_AKIRA_*=n
# - Use native_sim for testing complex features
# - Consider ESP32-S3 for WiFi + WAMR + Bluetooth + Storage
###############################################################################

CONFIG_AKIRA_WAMR_MINI_LOADER=y
CONFIG_AKIRA_WAMR_MINIMAL=y

# Reduced memory settings for WASM runtime
CONFIG_OCRE_WAMR_HEAP_BUFFER_SIZE=8192
CONFIG_OCRE_CONTAINER_DEFAULT_STACK_SIZE=2048
CONFIG_OCRE_CONTAINER_DEFAULT_HEAP_SIZE=8192
CONFIG_MAX_CONTAINERS=2
# Enable placing WAMR heap buffer in PSRAM when PSRAM is present.
# If this board has SPIRAM attached, uncomment the next line to place the
# OCRE WAMR heap buffer in external RAM.
# CONFIG_OCRE_WAMR_HEAP_BUFFER_IN_PSRAM=y
CONFIG_MULTI_HEAP=y
CONFIG_SHARED_MULTI_HEAP=y