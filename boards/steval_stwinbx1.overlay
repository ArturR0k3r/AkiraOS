/*
 * ST STEVAL-STWINBX1 Device Tree Overlay for AkiraOS
 * Board: steval_stwinbx1
 *
 * This board has many built-in sensors:
 * - IIS2DLPC: 3-axis accelerometer (SPI)
 * - ISM330DHCX: 6-axis IMU with ML Core (SPI)
 * - IIS2ICLX: 2-axis inclinometer with ML Core (SPI)
 * - STTS22H: Temperature sensor (I2C)
 * - IIS2MDC: 3-axis magnetometer (I2C)
 * - ILPS22QS: Pressure sensor (I2C)
 */

/
{
    chosen
    {
        zephyr, console = &usart2;
        zephyr, shell - uart = &usart2;
    };

    aliases
    {
        led0 = &green_led;
        led1 = &orange_led;
        sw0 = &user_button;
    };
};

/* Console via USART2 (available on SWD connector) */
&usart2
{
    status = "okay";
    current - speed = <115200>;
};

/* I2C2 for sensors (per board's actual configuration) */
&i2c2
{
    status = "okay";
    clock - frequency = <I2C_BITRATE_FAST>;

    /* STTS22H Temperature Sensor */
    stts22h @3f
    {
        compatible = "st,stts22h";
        reg = <0x3f>;
    };

    /* IIS2MDC Magnetometer */
    iis2mdc @1e
    {
        compatible = "st,iis2mdc";
        reg = <0x1e>;
        drdy - gpios = <&gpioe 6 GPIO_ACTIVE_HIGH>;
    };

    /* ILPS22QS Pressure Sensor */
    ilps22qs @5d
    {
        compatible = "st,ilps22qs";
        reg = <0x5d>;
    };
};

/* SPI2 motion sensors are already configured in base board DTS
 * Just ensure the interface is enabled - sensors are:
 * - iis2dlpc@0: 3-axis accelerometer
 * - ism330dhcx@1: 6-axis IMU with ML Core
 * - iis2iclx@2: 2-axis inclinometer with ML Core
 */
&spi2
{
    status = "okay";
};

/* Enable ADC for analog sensors */
&adc1
{
    status = "okay";
};

/* Enable USB for CDC ACM console */
&usbotg_fs
{
    status = "okay";
};

/* SD Card via SDMMC is already configured in base board DTS */
/* Just ensure it's enabled */
&sdmmc1
{
    status = "okay";
};

/* Note: FDCAN not configured - would need pinctrl setup */

/* Enable watchdog */
&iwdg
{
    status = "okay";
};

/* RTC requires proper clock source configuration
 * Disabled until clock source is set up in overlay
 */

/* Flash partitions are already defined in base board DTS
 * Storage partition at 0xf0000 (64KB) is available for NVS settings
 */
