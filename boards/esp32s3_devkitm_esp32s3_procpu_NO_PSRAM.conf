# ESP32-S3 DevKitM (NO PSRAM) Configuration
# Variant of esp32s3_devkitm_esp32s3_procpu with external PSRAM disabled

###############################################################################
# PSRAM (External SPIRAM) DISABLED
###############################################################################
CONFIG_ESP_SPIRAM=n
# CONFIG_ESP_SPIRAM_SIZE is undefined
# CONFIG_SPIRAM_MODE_OCT is undefined
CONFIG_AKIRA_PSRAM=n
# CONFIG_SPIRAM_TYPE_ESPPSRAM64 is undefined
# CONFIG_SPIRAM_SPEED_* are undefined

# Disable MEMC driver - not needed without PSRAM
CONFIG_MEMC=n

# Ensure we do not try to place rodata in PSRAM
CONFIG_SPIRAM_RODATA=n

# PSRAM memtest irrelevant
CONFIG_ESP_SPIRAM_MEMTEST=n

###############################################################################
# Thread Local Storage - REQUIRED for ESP32-S3 WAMR
###############################################################################
CONFIG_THREAD_LOCAL_STORAGE=y

###############################################################################
# Memory Configuration (no PSRAM)
###############################################################################
# Increase internal DRAM allocations to compensate for missing PSRAM
CONFIG_HEAP_MEM_POOL_SIZE=131072
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_SHELL_STACK_SIZE=4096

# Shared Multi-Heap disabled (no external heap)
#CONFIG_SHARED_MULTI_HEAP=n

###############################################################################
# ESP32-S3 WiFi/BT
###############################################################################
CONFIG_WIFI=y
CONFIG_ESP32_WIFI_STA_AUTO_DHCPV4=y

# SPI for display
CONFIG_SPI=y

# Sensor support
CONFIG_I2C=y
CONFIG_SENSOR=y

###############################################################################
# App Manager & PSRAM-dependent features disabled
###############################################################################
CONFIG_AKIRA_APP_MANAGER=n
CONFIG_AKIRA_FONTS_IN_PSRAM=n
CONFIG_AKIRA_FRAMEBUFFER_IN_PSRAM=n

# WAMR Heap: use internal default (smaller) when no PSRAM available
CONFIG_WAMR_HEAP_SIZE=262144

# Limit max containers to save memory
CONFIG_MAX_CONTAINERS=2

###############################################################################
# Logging
###############################################################################
CONFIG_LOG_MODE_IMMEDIATE=y

CONFIG_AKIRA_BT_ECHO=y
CONFIG_AKIRA_EMBEDDED_WEB=n

###############################################################################
# USB Stack
###############################################################################
CONFIG_UDC_DWC2_STACK_SIZE=4096
CONFIG_USBD_THREAD_STACK_SIZE=4096
